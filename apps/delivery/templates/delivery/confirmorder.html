{% extends "site_base.html" %}

{% load i18n %}
{% load leaflet_tags %}
{% load bootstrap %}

{% block head_title %}Confirm Order{% endblock %}
{% block body_class %}changeorder{% endblock %}

{% block css %}
	{% leaflet_css %}	
{% endblock %}

{% block head_js %}
	{% leaflet_js %}	
	<script type="text/javascript">
		function pickup(map, options) {
			var content = `<ul class='list-unstyled'>
							{% for x in orig.get_address %}
								<li>{{x}}</li>
							{% endfor %}
						</ul>`
			var mark = L.marker({{ orig.make_point }}).addTo(map);
			mark.bindPopup(content).openPopup();
			map.setView({{ orig.make_point }}, 17);
		}
		function dropoff(map, options) {
			var content = `<ul class='list-unstyled'>
							{% for x in dest.get_address %}
								<li>{{x}}</li>
							{% endfor %}
						</ul>`
			var mark = L.marker({{ dest.make_point }}).addTo(map);
			mark.bindPopup(content).openPopup();
			map.setView({{ dest.make_point }}, 17);
		}
	</script>
{% endblock %}

{% block body_base %}

<div class="container">
		<legend><h2>Review and Confirm Order</h2></legend>
</div>
<div class="container">
	<div class="col-xs-6">
		<legend>Pickup</legend>
		{% leaflet_map 'pickup' callback='window.pickup' %}
	</div>
	<div class="col-xs-6">
		<legend>Dropoff</legend>
		{% leaflet_map 'dropoff' callback='window.dropoff' %}
	</div>
</div>
<div class="container">
		<h3>--{{ order.get_duration }}--</h3>

		<form action="{% url 'delivery:confirmorder' %}" method="POST">

		{% csrf_token %}
</div>

<div class="container">
		{% for radio, price in prices %}
		<div class="col-xs-4">
			<label>
				<h4>{{ radio.choice_label }}</h4>
				<div class="container"><span>${{ price }}</span></div>
				<div class="container">{{ radio.tag }}</div>
			</label>
		</div>
		{% endfor %}

		{% if form.errors %}
			{% for field in form %}
				{% for error in field.errors %}
					<div class="alert alert-error">
						<strong>{{ error|escape }}</strong>
					</div>
				{% endfor %}
			{% endfor %}

			{% for error in form.non_field_errors %}
				<div class="alert alert-error">
					<strong>{{ error|escape }}</strong>
				</div>
			{% endfor %}
		{% endif %}

			<div class="col-xs-12">
				<div class="form-group" style="float:right;">
					<button type="submit" class="btn btn-primary">CONFIRM ORDER</button>
					  <!-- <input ="submit" value="Next"> -->
				</div>	
			</div>
			<!-- <input type="submit" value="submit"> -->
		</form>
</div>
{% endblock %}
